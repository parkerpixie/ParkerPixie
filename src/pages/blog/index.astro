---
/* Blog index â€” magazine grid, dark theme; safe when no posts exist */

// Use import.meta.glob (doesn't throw on no matches)
const modules = import.meta.glob('./*.md', { eager: true });

// Normalize into an array of page modules with url + frontmatter
type PostMod = { url?: string; frontmatter?: Record<string, any> };
const posts: PostMod[] = Object.values(modules);

// Sort newest first by frontmatter.date
posts.sort((a, b) => {
  const da = new Date(a.frontmatter?.date ?? 0).getTime();
  const db = new Date(b.frontmatter?.date ?? 0).getTime();
  return db - da;
});
---

<!doctype html>
<html lang="en">
  <head><meta charset="utf-8" /><title>Blog test</title></head>
  <body style="background:#0f0b14;color:#f7f3ff;font-family:system-ui;padding:24px">
    <h1>Blog is wired âœ…</h1>
    <p>If you can see this at /blog, the route works. Next weâ€™ll add the magazine grid.</p>
  </body>
</html>        border:1px solid rgba(255,255,255,.08);
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ParkerPixie Â· Blog</title>
    <meta name="description" content="The ParkerPixie blog â€” cozy crafts, capybara lore, gaming, and glittery life updates." />
    <link rel="icon" href="/CapyGoldIcon.png" />
    <style>
      :root{
        --brand:#8a5dff; --brand-deep:#4b2fb5; --gold:#D8AA3B;
        --ink:#f7f3ff; --muted:#bdb5d9;
        --bg1:#0f0b14; --bg2:#130e1f; --bg3:#100b1a;
        --card:#171220; --radius:18px;
      }
      *{box-sizing:border-box}
      html,body{margin:0;padding:0;background:linear-gradient(180deg,var(--bg1),var(--bg2) 40%,var(--bg3));color:var(--ink);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial}
      a{color:inherit;text-decoration:none}
      img{max-width:100%;height:auto;display:block}
      .wrap{max-width:1080px;margin:0 auto;padding:20px 20px 56px}

      /* Header (matches site) */
      header{position:sticky;top:0;z-index:50;background:rgba(15,11,20,.7);backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,.06)}
      .nav{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:12px 0}
      .brand{display:flex;align-items:center;gap:12px;font-weight:800;letter-spacing:.3px}
      .brand img{width:28px;height:28px;filter:drop-shadow(0 0 8px rgba(216,170,59,.45))}
      .brand span{font-size:18px}
      .links{display:flex;gap:16px}
      .links a{padding:8px 12px;border-radius:12px;transition:.2s ease}
      .links a:hover{background:rgba(255,255,255,.07)}
      .links a.cta{background:linear-gradient(135deg,var(--brand),var(--brand-deep));box-shadow:0 8px 30px rgba(138,93,255,.35)}
      .links a.cta:hover{transform:translateY(-1px)}

      /* Page header */
      .hero{margin-top:28px;display:flex;align-items:center;justify-content:space-between;gap:16px}
      .hero h1{font-size:clamp(28px,5vw,44px);margin:0}
      .hero p{color:var(--muted);margin:8px 0 0}

      /* Magazine grid */
      .grid{
        margin-top:22px;
        display:grid;
        grid-template-columns:repeat(3,1fr);
        gap:16px;
      }
      @media (max-width:1000px){ .grid{grid-template-columns:repeat(2,1fr)} }
      @media (max-width:640px){ .grid{grid-template-columns:1fr} }

      .card{
        display:flex;flex-direction:column;overflow:hidden;
        border-radius:var(--radius);
        background:linear-gradient(180deg,#1c152d,#181126);
        border:1px solid rgba(255,255,255,.08);
        box-shadow:0 20px 60px rgba(0,0,0,.35);
        min-height:280px;
      }
@@ -51,35 +112,36 @@
        </div>
      </div>

      {posts.length === 0 && (
        <p class="empty">No posts yetâ€”add a Markdown file next to this page (e.g. <code>src/pages/blog/hello-world.md</code>).</p>
      {posts.length === 0 ? (
        <p class="empty">No posts yet â€” add a Markdown file here: <code>src/pages/blog/hello-world.md</code>.</p>
      ) : (
        <section class="grid" aria-label="Magazine posts">
          {posts.map((mod: any) => {
            const url = mod.url ?? '#';
            const fm = mod.frontmatter ?? {};
            const cover = fm.cover ?? '/hero.jpg';
            const title = fm.title ?? 'Untitled';
            const date = fm.date ? new Date(fm.date).toLocaleDateString() : '';
            const desc = fm.description ?? '';
            const tags = Array.isArray(fm.tags) ? fm.tags : [];
            return (
              <a class="card" href={url}>
                <div class="thumb"><img src={cover} alt="" loading="lazy" /></div>
                <div class="body">
                  <h2 class="title">{title}</h2>
                  {date && <p class="meta">{date}</p>}
                  {desc && <p class="excerpt">{desc}</p>}
                  {tags.length > 0 && (
                    <div class="tags">
                      {tags.map((t: string) => <span class="tag">{t}</span>)}
                    </div>
                  )}
                </div>
              </a>
            );
          })}
        </section>
      )}

      <section class="grid" aria-label="Magazine posts">
        {posts.map(({ url, frontmatter }) => {
          const cover = frontmatter?.cover ?? '/hero.jpg'; // fall back to hero
          const title = frontmatter?.title ?? 'Untitled';
          const date = frontmatter?.date ? new Date(frontmatter.date).toLocaleDateString() : '';
          const desc = frontmatter?.description ?? '';
          const tags = frontmatter?.tags ?? [];
          return (
            <a class="card" href={url}>
              <div class="thumb"><img src={cover} alt="" loading="lazy" /></div>
              <div class="body">
                <h2 class="title">{title}</h2>
                {date && <p class="meta">{date}</p>}
                {desc && <p class="excerpt">{desc}</p>}
                {tags.length > 0 && (
                  <div class="tags">
                    {tags.map((t) => <span class="tag">{t}</span>)}
                  </div>
                )}
              </div>
            </a>
          );
        })}
      </section>

      <footer>
        Â© <span id="y"></span> ParkerPixie Â· Made with âœ¨ glitter âœ¨, ðŸ’ƒ sass ðŸ’ƒ, and ðŸ’– love ðŸ’– from Madison, WI
      </footer>
@@ -90,4 +152,3 @@
    </script>
  </body>
</html>
